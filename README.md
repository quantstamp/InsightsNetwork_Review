# Overview

This smart contract audit was prepared by [Quantstamp](https://www.quantstamp.com/), the protocol for securing smart contracts.

This security audit report follows a generic template. Future Quantstamp reports will follow a similar template and they will be fully generated by automated tools.

## Specification

Our understanding of the specification was based on the following documentation:
* [Functional Specification](https://github.com/INSNetwork/ethsmartcontracts/wiki/Insights-Network-Contributions)

We also reviewed the instructions provided in the [README.md](https://github.com/INSNetwork/ethsmartcontracts/blob/crowdfunding_contract/README.md) file in the github repository at the time of the audit.

## Methodology

The review was conducted during 2018-Jan-31 thru 2017-Feb-02 by the Quantstamp team, which included senior engineers Kacper Bak, Steven Stewart, and Alex Murashkin.

Their procedure can be summarized as follows:

1. Code review
    * Review of the specification
    * Manual review of code
    * Comparison to specification
2. Testing and automated analysis
    * Test coverage analysis
    * Symbolic execution (automated code path evaluation)
3. Best-practices review
4. Itemize recommendations

## Source Code

The following source code was reviewed during the audit.

| Repository                            | Commit                                                                                   |
|---------------------------------------|------------------------------------------------------------------------------------------|
| [ethsmartcontracts](https://github.com/INSNetwork/ethsmartcontracts)  | [d64e43b](https://github.com/INSNetwork/ethsmartcontracts/commit/d64e43b9108c1afee2320b5bf190a1aeb80e0924) |

# Security Audit

Quantstamp's objective was to evaluate the Insight Network Contributions contract for security-related issues, code quality, and adherence to best-practices.

Possible issues include (but are not limited to):

* Transaction-ordering dependence
* Timestamp dependence
* Mishandled exceptions and call stack limits
* Unsafe external calls
* Integer overflow / underflow
* Number rounding errors
* Reentrancy and cross-function vulnerabilities
* Denial of service / logical oversights

# Test coverage

We evaluated the test coverage using truffle and solidity-coverage. The below notes outline the setup and steps that were performed.

## Setup

Testing setup:
* Truffle v4.0.1
* TestRPC v6.0.7
* solidity-coverage v0.4.9
* Oyente v0.2.7
* Mythril v0.10.7
* truffle-flattener v1.2.1

## Steps

Steps taken to run the full test suite:

* Installed dependencies as described in the file [README.md](https://github.com/INSNetwork/ethsmartcontracts/blob/crowdfunding_contract/README.md).
* Installed the `solidity-coverage` tool: `npm install --save-dev solidity-coverage`.
* Ran the coverage tool: `./node_modules/.bin/solidity-coverage`
* To workaround limitations of the Oyente tool, we flattened the source code using truffle-flattener.

## Evaluation

The coverage result of the `InsightsNetworkContributions.sol` file:
```
100% Statements 37/37
76.67% Branches 23/30
100% Functions 8/8
100% Lines 38/38
```

We evaluated the coverage report and identified missing test coverage for `else` paths of `require()` statements. For example, `require(_contributionMinimum <= _contributionMaximum);`, does not have any tests covering cases when the underlying expression evaluates to `false`. We recommend adding tests to cover these edge cases.

Symbolic execution (the Oyente tool) did not detect any vulnerabilities of types Parity Multisig Bug 2, Callstack Depth Attack, Timestamp Dependency, and Re-Entrancy Vulnerability.

Oyente reported a potential Transaction-Ordering Dependence (TOD) attack between `recipient.transfer(amount)` (line 78 of function `transfer()`) and `selfdestruct(owner)` (line 84 of function `selfDestruct()`), however we believe this to be a benign issue. A concern is that the contract is destroyed before the transfer occurs. We do not consider this an issue since both methods may only be called by the contract owner. Furthermore, `selfDestruct()` requires that the balance is 0, therefore transfer could not occur anyway.

Oyente reported that EVM code coverage is `99.6%`. The tool explored almost all the possible paths.

Mythril tool reported that a non-zero amount of Ether is sent to an address taken from function arguments in `recipient.transfer(amount)`  (line 78 of function `transfer()`). We believe this to be a false positive, since the function `transfer()` is protected by the modifier `onlyOwner`.

# Recommendations

## Reusing Standard Zeppelin Contracts

We noticed that the contract has the boolean field `enabled`. From our understanding, it plays similar role to `paused` in the standard Zeppelin's contract `Pausable`. We recommend reusing well-tested and well-known code as a best practice.

## Code Documentation

We noted that majority of the functions were self-explanatory. Standard documentation tags (such as `@dev`, `@param`, and `@returns`) were missing. We recommend adding these tags as a best practice and for documenting the assumptions.

The functional specification explains that 0.25 ETH <= (the first amount sent) <= 50 ETH. The contract allows for flexibility and does not strictly follow the specification. We do not see any issue, but if the min and max contributions are known upfront, they could be defined as constants in the contract. Alternatively, a short comment explaning the need for flexibility would be helpful.

# Appendix

## File Signatures

Below are SHA256 file signatures of the relevant files reviewed in the audit.

```
$ shasum -a 256 ./contracts/* ./contracts/*/* ./contracts/*/*/*
9c089d46e238aac691f8785a8677b4e6dd46a0ff88747bdc74589f47ec7b2bab  ./contracts/InsightsNetworkContributions.sol

$ shasum -a 256 ./test/* ./test/*/*
b656f3b90343e40848945c868413a780b5f891e00c5da73759ab4e911c1ff93a  ./test/InsightsNetworkContributions.js

```

# Disclosure

## Purpose of report

The scope of our review is limited to a review of Solidity code and only the source code we note as being within the scope of our review within this report. Cryptographic tokens are emergent technologies and carry with them high levels of technical risk and uncertainty. The Solidity language itself remains under development and is subject to unknown risks and flaws. The review does not extend to the compiler layer, or any other areas beyond Solidity that could present security risks.

The report is not an endorsement or indictment of any particular project or team, and the report does not guarantee the security of any particular project. This report does not consider, and should not be interpreted as considering or having any bearing on, the potential economics of a token, token sale or any other product, service or other asset.

No third party should rely on the reports in any way, including for the purpose of making any decisions to buy or sell any token, product, service or other asset. Specifically, for the avoidance of doubt, this report does not constitute investment advice, is not intended to be relied upon as investment advice, is not an endorsement of this project or team, and it is not a guarantee as to the absolute security of the project.

## Links to other websites
You may, through hypertext or other computer links, gain access to web sites operated by persons other than Quantstamp Technologies Inc. (QTI). Such hyperlinks are provided for your reference and convenience only, and are the exclusive responsibility of such web sites' owners. You agree that QTI are not responsible for the content or operation of such web sites, and that QTI shall have no liability to you or any other person or entity for the use of third-party web sites. Except as described below, a hyperlink from this web site to another web site does not imply or mean that QTI endorses the content on that web site or the operator or operations of that site. You are solely responsible for determining the extent to which you may use any content at any other web sites to which you link from the report. QTI assumes no responsibility for the use of third-party software on the website and shall have no liability whatsoever to any person or entity for the accuracy or completeness of any outcome generated by such software.

## Timeliness of content
The content contained in the report is current as of the date appearing on the report and is subject to change without notice, unless indicated otherwise by QTI; however, QTI does not guarantee or warrant the accuracy, timeliness, or completeness of any report you access using the internet or other means, and assumes no obligation to update any information following publication.
